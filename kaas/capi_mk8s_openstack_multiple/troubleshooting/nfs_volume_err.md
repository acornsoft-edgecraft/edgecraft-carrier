## nfs 볼륨으로 인스탄스 생성시 오류 발생

```sh
메시지
Build of instance 0cabbcce-3b06-448d-82c3-fa1e398f16f4 aborted: The request you have made requires authentication. (HTTP 401)
코드
500
세부 정보
Traceback (most recent call last): File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 1976, in _prep_block_device driver_block_device.attach_block_devices( File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 874, in attach_block_devices _log_and_attach(device) File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 871, in _log_and_attach bdm.attach(*attach_args, **attach_kwargs) File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 752, in attach self.volume_id, self.attachment_id = self._create_volume( File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 384, in _create_volume self._call_wait_func(context, wait_func, volume_api, vol['id']) File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 721, in _call_wait_func wait_func(context, volume_id) File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 1580, in _await_block_device_map_created volume = self.volume_api.get(context, vol_id) File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 396, in wrapper res = method(self, ctx, *args, **kwargs) File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 432, in wrapper res = method(self, ctx, volume_id, *args, **kwargs) File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 498, in get item = cinderclient( File "/usr/lib/python3/dist-packages/cinderclient/v2/volumes.py", line 281, in get return self._get("/volumes/%s" % volume_id, "volume") File "/usr/lib/python3/dist-packages/cinderclient/base.py", line 291, in _get resp, body = self.api.client.get(url) File "/usr/lib/python3/dist-packages/cinderclient/client.py", line 214, in get return self._cs_request(url, 'GET', **kwargs) File "/usr/lib/python3/dist-packages/cinderclient/client.py", line 205, in _cs_request return self.request(url, method, **kwargs) File "/usr/lib/python3/dist-packages/cinderclient/client.py", line 191, in request raise exceptions.from_response(resp, body) cinderclient.exceptions.Unauthorized: The request you have made requires authentication. (HTTP 401) During handling of the above exception, another exception occurred: Traceback (most recent call last): File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 2605, in _build_resources block_device_info = self._prep_block_device(context, instance, File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 1996, in _prep_block_device raise exception.InvalidBDM(str(ex)) nova.exception.InvalidBDM: The request you have made requires authentication. (HTTP 401) During handling of the above exception, another exception occurred: Traceback (most recent call last): File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 2232, in _do_build_and_run_instance self._build_and_run_instance(context, instance, image, File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 2441, in _build_and_run_instance compute_utils.notify_about_instance_create( File "/usr/lib/python3/dist-packages/oslo_utils/excutils.py", line 227, in __exit__ self.force_reraise() File "/usr/lib/python3/dist-packages/oslo_utils/excutils.py", line 200, in force_reraise raise self.value File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 2392, in _build_and_run_instance with self._build_resources(context, instance, File "/usr/lib/python3.8/contextlib.py", line 113, in __enter__ return next(self.gen) File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 2615, in _build_resources raise exception.BuildAbortException(instance_uuid=instance.uuid, nova.exception.BuildAbortException: Build of instance 0cabbcce-3b06-448d-82c3-fa1e398f16f4 aborted: The request you have made requires authentication. (HTTP 401)
생성됨
2023년 4월 28일 11:22 오전
```

```log
2023-05-02 12:53:29.168 1934973 ERROR nova.volume.cinder [req-b4c71992-76ce-4ab7-8a29-e60b83bf1d88 1271c61cec044228b178a70451a71c92 3b66b69a8d2441708d1773c7cf49de25 - default default] Update attachment failed for attachment 2382ee3b-1304-4938-a042-90c00d69c2b3. Error: Unable to update the attachment. (HTTP 500) (Request-ID: req-526c351d-7ef9-4784-bfe4-f87645a0602f) Code: 500: cinderclient.exceptions.ClientException: Unable to update the attachment. (HTTP 500) (Request-ID: req-526c351d-7ef9-4784-bfe4-f87645a0602f)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [req-b4c71992-76ce-4ab7-8a29-e60b83bf1d88 1271c61cec044228b178a70451a71c92 3b66b69a8d2441708d1773c7cf49de25 - default default] [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413] Instance failed block device setup: cinderclient.exceptions.ClientException: Unable to update the attachment. (HTTP 500) (Request-ID: req-526c351d-7ef9-4784-bfe4-f87645a0602f)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413] Traceback (most recent call last):
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/compute/manager.py", line 1976, in _prep_block_device
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     driver_block_device.attach_block_devices(
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 874, in attach_block_devices
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     _log_and_attach(device)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 871, in _log_and_attach
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     bdm.attach(*attach_args, **attach_kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 757, in attach
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     super(DriverVolSnapshotBlockDevice, self).attach(
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 46, in wrapped
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     ret_val = method(obj, context, *args, **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 672, in attach
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     self._do_attach(context, instance, volume, volume_api,
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 657, in _do_attach
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     self._volume_attach(context, volume, connector, instance,
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/virt/block_device.py", line 571, in _volume_attach
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     connection_info = volume_api.attachment_update(
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 396, in wrapper
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     res = method(self, ctx, *args, **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 447, in wrapper
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     res = method(self, ctx, attachment_id, *args, **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 875, in attachment_update
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     LOG.error('Update attachment failed for attachment '
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/oslo_utils/excutils.py", line 227, in __exit__
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     self.force_reraise()
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/oslo_utils/excutils.py", line 200, in force_reraise
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     raise self.value
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/nova/volume/cinder.py", line 867, in attachment_update
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     attachment_ref = cinderclient(
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/cinderclient/api_versions.py", line 423, in substitution
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     return method.func(obj, *args, **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/cinderclient/v3/attachments.py", line 74, in update
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     resp = self._update('/attachments/%s' % id, body)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/cinderclient/base.py", line 312, in _update
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     resp, body = self.api.client.put(url, body=body, **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/cinderclient/client.py", line 220, in put
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     return self._cs_request(url, 'PUT', **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/cinderclient/client.py", line 205, in _cs_request
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     return self.request(url, method, **kwargs)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]   File "/usr/lib/python3/dist-packages/cinderclient/client.py", line 191, in request
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413]     raise exceptions.from_response(resp, body)
2023-05-02 12:53:29.236 1934973 ERROR nova.compute.manager [instance: 73acabd5-ce5a-4e26-ae9e-ad4a0977b413] cinderclient.exceptions.ClientException: Unable to update the attachment. (HTTP 500) (Request-ID: req-526c351d-7ef9-4784-bfe4-f87645a0602f)
```